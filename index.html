<!DOCTYPE html>
<html lang="fa" dir="rtl" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Acioai</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Vazirmatn', sans-serif;
    }
    .chat-bubble-user {
      background: linear-gradient(135deg, #10B981 0%, #059669 100%);
      border-radius: 20px 20px 4px 20px;
    }
    .chat-bubble-ai {
      background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%);
      border-radius: 20px 20px 20px 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,0.3);
    }
    .typing-dot {
      animation: typing 1.4s infinite;
    }
    .typing-dot:nth-child(2) { animation-delay: 0.2s; }
    .typing-dot:nth-child(3) { animation-delay: 0.4s; }
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
      30% { transform: translateY(-8px); opacity: 1; }
    }
    .fade-in {
      animation: fadeIn 0.3s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .slide-up {
      animation: slideUp 0.4s ease-out;
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(100%); }
      to { opacity: 1; transform: translateY(0); }
    }
    .pulse-glow {
      animation: pulseGlow 2s infinite;
    }
    @keyframes pulseGlow {
      0%, 100% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.3); }
      50% { box-shadow: 0 0 40px rgba(16, 185, 129, 0.6); }
    }
    .nav-item {
      transition: all 0.3s ease;
    }
    .nav-item:hover {
      transform: translateY(-2px);
    }
    .nav-item.active {
      background: linear-gradient(135deg, #10B981 0%, #059669 100%);
      color: white;
    }
    .input-glow:focus {
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
    }
    .btn-primary {
      background: linear-gradient(135deg, #10B981 0%, #059669 100%);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
    }
    .btn-primary:active {
      transform: translateY(0);
    }
    .scroll-smooth::-webkit-scrollbar {
      width: 6px;
    }
    .scroll-smooth::-webkit-scrollbar-track {
      background: transparent;
    }
    .scroll-smooth::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
    }
    .ad-card {
      transition: all 0.3s ease;
    }
    .ad-card:hover {
      transform: scale(1.02);
      box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    }
    .icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
  </style>
</head>
<body class="h-full bg-gradient-to-br from-emerald-50 via-white to-teal-50">
  <div id="app" class="h-full flex flex-col overflow-hidden">
    
    <!-- Auth Screen -->
    <div id="auth-screen" class="h-full flex items-center justify-center p-4">
      <div class="glass-card rounded-3xl p-8 w-full max-w-md shadow-2xl slide-up">
        <!-- Logo -->
        <div class="text-center mb-8">
          <div class="w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden pulse-glow">
            <img src="https://cdn.imgurl.ir/uploads/s369564_photo-output.jpeg" alt="Acioai Logo" class="w-full h-full object-cover" loading="lazy" onerror="this.style.background='linear-gradient(135deg, #10B981 0%, #059669 100%)'; this.alt='Logo';">
          </div>
          <h1 id="auth-title" class="text-3xl font-bold text-gray-800 mb-2">Acioai</h1>
          <p class="text-gray-500">Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø´Ù…Ø§</p>
        </div>
        
        <!-- Auth Form -->
        <form id="auth-form" class="space-y-4">
          <div id="name-field">
            <label for="name-input" class="block text-sm font-medium text-gray-700 mb-2">Ù†Ø§Ù…</label>
            <input type="text" id="name-input" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" 
                   class="w-full px-4 py-3 rounded-xl border border-gray-200 input-glow focus:outline-none focus:border-emerald-500 transition-all">
          </div>
          <div>
            <label for="email-input" class="block text-sm font-medium text-gray-700 mb-2">Ø§ÛŒÙ…ÛŒÙ„</label>
            <input type="email" id="email-input" placeholder="email@example.com" 
                   class="w-full px-4 py-3 rounded-xl border border-gray-200 input-glow focus:outline-none focus:border-emerald-500 transition-all">
          </div>
          <div id="auth-error" class="hidden text-red-500 text-sm text-center py-2 bg-red-50 rounded-lg"></div>
          <button type="submit" id="auth-submit" class="btn-primary w-full py-3 rounded-xl text-white font-medium">
            Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
          </button>
        </form>
        
        <div class="mt-6 text-center">
          <button id="toggle-auth" class="text-emerald-600 hover:text-emerald-700 font-medium transition-colors">
            Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø±ÛŒØ¯ØŸ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯
          </button>
        </div>
      </div>
    </div>
    
    <!-- Main App -->
    <div id="main-app" class="hidden h-full flex flex-col">
      
      <!-- Header -->
      <header class="glass-card border-b border-gray-100 px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-full overflow-hidden">
            <img src="https://cdn.imgurl.ir/uploads/s369564_photo-output.jpeg" alt="Logo" class="w-full h-full object-cover" loading="lazy" onerror="this.style.background='#10B981';">
          </div>
          <div>
            <h1 id="header-title" class="font-bold text-gray-800">Acioai</h1>
            <p id="user-display" class="text-xs text-gray-500"></p>
          </div>
        </div>
        <button id="logout-btn" class="p-2 rounded-lg hover:bg-gray-100 transition-colors" title="Ø®Ø±ÙˆØ¬">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
          </svg>
        </button>
      </header>
      
      <!-- Navigation -->
      <nav class="glass-card border-b border-gray-100 px-4 py-2">
        <div class="flex gap-2 overflow-x-auto">
          <button data-page="chat" class="nav-item active px-4 py-2 rounded-xl text-sm font-medium whitespace-nowrap flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
            </svg>
            Ú†Øª
          </button>
          <button data-page="faq" class="nav-item px-4 py-2 rounded-xl text-sm font-medium text-gray-600 whitespace-nowrap flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3C6.477 3 2 6.582 2 11c0 5.174 3.588 9.542 8.563 9.947 1.047.135 1.369.395 1.369 2.645 0 .86-.264 1.338 1.684 2.53 1.023.692 3.172 1.746 3.172-1.97V20.5c4.970-.725 8.211-4.514 8.211-9.5 0-4.418-4.086-8-9.5-8z"></path>
            </svg>
            Ø³ÙˆØ§Ù„Ø§Øª
          </button>
          <button data-page="ads" class="nav-item px-4 py-2 rounded-xl text-sm font-medium text-gray-600 whitespace-nowrap flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.961 1.961 0 01-2.437-1.97V5.882m0 0a1.96 1.96 0 00-2.437 1.97m0 0V5.5c0-.891.12-1.751.364-2.59m0 0C5.307 1.364 6.308 1 7.5 1c2.979 0 5.497 1.98 6.5 4.5M15 19.24l.364 2.59c1.192-.891 2.287-2.274 2.934-3.978.772-2.295.77-4.042 0-5.957m0 0c1.194-2.54 3.106-4.251 5.03-5.791"></path>
            </svg>
            ØªØ¨Ù„ÛŒØºØ§Øª
          </button>
          <button data-page="profile" class="nav-item px-4 py-2 rounded-xl text-sm font-medium text-gray-600 whitespace-nowrap flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            Ù¾Ø±ÙˆÙØ§ÛŒÙ„
          </button>
        </div>
      </nav>
      
      <!-- Content Area -->
      <main class="flex-1 overflow-hidden">
        
        <!-- Chat Page -->
        <div id="chat-page" class="h-full flex flex-col">
          <div id="chat-messages" class="flex-1 overflow-y-auto scroll-smooth p-4 space-y-4">
            <!-- Welcome Message -->
            <div class="chat-bubble-ai p-4 max-w-[85%] fade-in">
              <p id="welcome-text" class="text-gray-700">Ø³Ù„Ø§Ù…! Ù…Ù† Acioai Ù‡Ø³ØªÙ…ØŒ Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø´Ù…Ø§. Ú†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ú©Ù…Ú©ØªÙˆÙ† Ú©Ù†Ù…ØŸ</p>
            </div>
          </div>
          
          <!-- Chat Input -->
          <div class="glass-card border-t border-gray-100 p-4">
            <form id="chat-form" class="flex gap-3">
              <input type="text" id="chat-input" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..." 
                     class="flex-1 px-4 py-3 rounded-xl border border-gray-200 input-glow focus:outline-none focus:border-emerald-500 transition-all">
              <button type="submit" id="send-btn" class="btn-primary px-6 py-3 rounded-xl text-white font-medium flex items-center gap-2">
                <span>Ø§Ø±Ø³Ø§Ù„</span>
                <svg class="w-5 h-5 rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                </svg>
              </button>
            </form>
            <p id="message-counter" class="text-xs text-gray-400 mt-2 text-center"></p>
          </div>
        </div>
        
        <!-- FAQ Page -->
        <div id="faq-page" class="hidden h-full overflow-y-auto scroll-smooth p-4">
          <div class="max-w-2xl mx-auto">
            <div class="mb-6">
              <input type="text" id="faq-search" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø³ÙˆØ§Ù„Ø§Øª..." 
                     class="w-full px-4 py-3 rounded-xl border border-gray-200 input-glow focus:outline-none focus:border-emerald-500 transition-all">
            </div>
            <div id="faq-list" class="space-y-3">
              <div class="glass-card rounded-xl p-4 cursor-pointer hover:shadow-lg transition-all">
                <h3 class="font-medium text-gray-800 mb-2">Acioai Ú†ÛŒØ³ØªØŸ</h3>
                <p class="text-gray-600 text-sm">Acioai ÛŒÚ© Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¨Ù‡ Ø´Ù…Ø§ Ø¯Ø± Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>
              </div>
              <div class="glass-card rounded-xl p-4 cursor-pointer hover:shadow-lg transition-all">
                <h3 class="font-medium text-gray-800 mb-2">Ú†Ú¯ÙˆÙ†Ù‡ Ø§Ø² Ú†Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù…ØŸ</h3>
                <p class="text-gray-600 text-sm">Ú©Ø§ÙÛŒØ³Øª Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ú©Ø§Ø¯Ø± Ù¾ÛŒØ§Ù… Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ Ùˆ Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</p>
              </div>
              <div class="glass-card rounded-xl p-4 cursor-pointer hover:shadow-lg transition-all">
                <h3 class="font-medium text-gray-800 mb-2">Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ</h3>
                <p class="text-gray-600 text-sm">Ø¨Ø³ØªÙ‡ Ø¨Ù‡ Ù†ÙˆØ¹ Ø§Ø´ØªØ±Ø§Ú© Ø´Ù…Ø§ØŒ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù¾ÛŒØ§Ù… Ù…ØªÙØ§ÙˆØª Ø§Ø³Øª. Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ø§ÛŒÚ¯Ø§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡ 10 Ù¾ÛŒØ§Ù… Ø¯Ø§Ø±Ù†Ø¯.</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Ads Page -->
        <div id="ads-page" class="hidden h-full overflow-y-auto scroll-smooth p-4">
          <div class="max-w-2xl mx-auto">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.961 1.961 0 01-2.437-1.97V5.882m0 0a1.96 1.96 0 00-2.437 1.97m0 0V5.5c0-.891.12-1.751.364-2.59m0 0C5.307 1.364 6.308 1 7.5 1c2.979 0 5.497 1.98 6.5 4.5M15 19.24l.364 2.59c1.192-.891 2.287-2.274 2.934-3.978.772-2.295.77-4.042 0-5.957m0 0c1.194-2.54 3.106-4.251 5.03-5.791"></path>
              </svg>
              ØªØ¨Ù„ÛŒØºØ§Øª ÙˆÛŒÚ˜Ù‡
            </h2>
            <div id="ads-list" class="grid gap-4">
              <div id="ads-loading" class="text-center py-8 text-gray-500">
                <div class="flex justify-center gap-1 mb-2">
                  <div class="w-2 h-2 bg-emerald-500 rounded-full typing-dot"></div>
                  <div class="w-2 h-2 bg-emerald-500 rounded-full typing-dot"></div>
                  <div class="w-2 h-2 bg-emerald-500 rounded-full typing-dot"></div>
                </div>
                Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...
              </div>
            </div>
          </div>
        </div>
        
        <!-- Profile Page -->
        <div id="profile-page" class="hidden h-full overflow-y-auto scroll-smooth p-4">
          <div class="max-w-md mx-auto">
            <div class="glass-card rounded-2xl p-6 text-center mb-6">
              <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-emerald-400 to-teal-500 flex items-center justify-center">
                <span id="profile-avatar" class="text-3xl font-bold text-white">A</span>
              </div>
              <h2 id="profile-name" class="text-xl font-bold text-gray-800 mb-1">Ú©Ø§Ø±Ø¨Ø±</h2>
              <p id="profile-email" class="text-gray-500 text-sm mb-4">email@example.com</p>
              <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-100 text-emerald-700">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <span id="profile-subscription">Free</span>
              </div>
            </div>
            
            <div class="glass-card rounded-2xl p-6">
              <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                Ø¢Ù…Ø§Ø± Ø§Ù…Ø±ÙˆØ²
              </h3>
              <div class="space-y-4">
                <div class="flex justify-between items-center">
                  <span class="text-gray-600">Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ</span>
                  <span id="profile-messages" class="font-bold text-emerald-600">0 / 10</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                  <div id="profile-progress" class="bg-gradient-to-r from-emerald-400 to-teal-500 h-2 rounded-full transition-all" style="width: 0%"></div>
                </div>
              </div>
            </div>
            
            <div class="mt-6 grid gap-3">
              <div class="glass-card rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center">
                  <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <p class="font-medium text-gray-800">Free</p>
                  <p class="text-xs text-gray-500">10 Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡</p>
                </div>
              </div>
              <div class="glass-card rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                  <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <p class="font-medium text-gray-800">Go</p>
                  <p class="text-xs text-gray-500">25 Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡</p>
                </div>
              </div>
              <div class="glass-card rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center">
                  <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3C6.477 3 2 6.582 2 11c0 5.174 3.588 9.542 8.563 9.947 1.047.135 1.369.395 1.369 2.645 0 .86-.264 1.338 1.684 2.53 1.023.692 3.172 1.746 3.172-1.97V20.5c4.970-.725 8.211-4.514 8.211-9.5 0-4.418-4.086-8-9.5-8z"></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <p class="font-medium text-gray-800">Pro</p>
                  <p class="text-xs text-gray-500">40 Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡</p>
                </div>
              </div>
              <div class="glass-card rounded-xl p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-yellow-100 flex items-center justify-center">
                  <svg class="w-5 h-5 text-yellow-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                </div>
                <div class="flex-1">
                  <p class="font-medium text-gray-800">Plus</p>
                  <p class="text-xs text-gray-500">50 Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </main>
    </div>
    
  </div>

  <script>
    // Configuration
    const API_BASE = 'https://script.google.com/macros/s/AKfycbzFnztCLVqfKOiGMhvtwFmlIQC-086TQi1zAl0zojs0EYqukTrQgqrfRdOmKiiPzBbt/exec';
    
    const defaultConfig = {
      app_title: 'Acioai',
      welcome_message: 'Ø³Ù„Ø§Ù…! Ù…Ù† Acioai Ù‡Ø³ØªÙ…ØŒ Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø´Ù…Ø§. Ú†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ú©Ù…Ú©ØªÙˆÙ† Ú©Ù†Ù…ØŸ',
      primary_color: '#10B981',
      secondary_color: '#ffffff',
      text_color: '#1f2937',
      accent_color: '#059669',
      bg_color: '#ecfdf5'
    };
    
    // State
    let currentUser = null;
    let isLoginMode = false;
    let dailyMessages = 0;
    let maxMessages = 10;
    let chatHistory = [];
    let adsData = [];
    let isLoading = false;
    
    // DOM Elements
    const authScreen = document.getElementById('auth-screen');
    const mainApp = document.getElementById('main-app');
    const authForm = document.getElementById('auth-form');
    const nameField = document.getElementById('name-field');
    const nameInput = document.getElementById('name-input');
    const emailInput = document.getElementById('email-input');
    const authSubmit = document.getElementById('auth-submit');
    const toggleAuth = document.getElementById('toggle-auth');
    const authError = document.getElementById('auth-error');
    const authTitle = document.getElementById('auth-title');
    const headerTitle = document.getElementById('header-title');
    const userDisplay = document.getElementById('user-display');
    const logoutBtn = document.getElementById('logout-btn');
    const chatMessages = document.getElementById('chat-messages');
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');
    const sendBtn = document.getElementById('send-btn');
    const messageCounter = document.getElementById('message-counter');
    const welcomeText = document.getElementById('welcome-text');
    const profileName = document.getElementById('profile-name');
    const profileEmail = document.getElementById('profile-email');
    const profileAvatar = document.getElementById('profile-avatar');
    const profileSubscription = document.getElementById('profile-subscription');
    const profileMessages = document.getElementById('profile-messages');
    const profileProgress = document.getElementById('profile-progress');
    const adsList = document.getElementById('ads-list');
    const adsLoading = document.getElementById('ads-loading');
    const faqSearch = document.getElementById('faq-search');
    
    // Subscription limits
    const subscriptionLimits = {
      'Free': 10,
      'Go': 25,
      'Pro': 40,
      'Plus': 50
    };
    

    
    // Initialize SDKs
    async function initializeApp() {
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            applyConfig(config);
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.bg_color || defaultConfig.bg_color,
                set: (value) => window.elementSdk.setConfig({ bg_color: value })
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => window.elementSdk.setConfig({ secondary_color: value })
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => window.elementSdk.setConfig({ text_color: value })
              },
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => window.elementSdk.setConfig({ primary_color: value })
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => window.elementSdk.setConfig({ accent_color: value })
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ['app_title', config.app_title || defaultConfig.app_title],
            ['welcome_message', config.welcome_message || defaultConfig.welcome_message]
          ])
        });
      }
      
      const savedUser = localStorage.getItem('acioai_user');
      if (savedUser) {
        try {
          currentUser = JSON.parse(savedUser);
          showMainApp();
        } catch (e) {
          localStorage.removeItem('acioai_user');
        }
      }
    }
    
    function applyConfig(config) {
      const title = config.app_title || defaultConfig.app_title;
      const welcome = config.welcome_message || defaultConfig.welcome_message;
      const primary = config.primary_color || defaultConfig.primary_color;
      const secondary = config.secondary_color || defaultConfig.secondary_color;
      const text = config.text_color || defaultConfig.text_color;
      const accent = config.accent_color || defaultConfig.accent_color;
      const bg = config.bg_color || defaultConfig.bg_color;
      
      authTitle.textContent = title;
      headerTitle.textContent = title;
      document.title = title;
      
      welcomeText.textContent = welcome;
      
      document.body.style.background = `linear-gradient(135deg, ${bg} 0%, #ffffff 50%, ${bg}88 100%)`;
      
      document.querySelectorAll('.btn-primary').forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${primary} 0%, ${accent} 100%)`;
      });
      
      document.querySelectorAll('.nav-item.active').forEach(nav => {
        nav.style.background = `linear-gradient(135deg, ${primary} 0%, ${accent} 100%)`;
      });
      
      document.querySelectorAll('.text-gray-800').forEach(el => {
        el.style.color = text;
      });
      
      document.querySelectorAll('.glass-card').forEach(card => {
        card.style.background = `${secondary}f5`;
      });
    }
    
    // Auth Functions
    function toggleAuthMode() {
      isLoginMode = !isLoginMode;
      nameField.classList.toggle('hidden', isLoginMode);
      authSubmit.textContent = isLoginMode ? 'ÙˆØ±ÙˆØ¯' : 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…';
      toggleAuth.textContent = isLoginMode ? 'Ø­Ø³Ø§Ø¨ Ù†Ø¯Ø§Ø±ÛŒØ¯ØŸ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†ÛŒØ¯' : 'Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø±ÛŒØ¯ØŸ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯';
      authError.classList.add('hidden');
    }
    
    function showError(message) {
      authError.textContent = message;
      authError.classList.remove('hidden');
    }
    
    async function handleAuth(e) {
      e.preventDefault();
      
      const email = emailInput.value.trim();
      const name = nameInput.value.trim();
      
      if (!email) {
        showError('Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ…ÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
        return;
      }
      
      if (!isLoginMode && !name) {
        showError('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
        return;
      }
      
      authSubmit.disabled = true;
      authSubmit.textContent = 'Ù„Ø·ÙØ§Ù‹ ØµØ¨Ø± Ú©Ù†ÛŒØ¯...';
      
      try {
        const action = isLoginMode ? 'login' : 'register';
        let url = `${API_BASE}?action=${action}&email=${encodeURIComponent(email)}`;
        if (!isLoginMode) {
          url += `&name=${encodeURIComponent(name)}`;
        }
        
        const response = await fetch(url);
        const data = await response.json();
        
        if (data.ok && data.Result) {
          currentUser = data.Result;
          maxMessages = subscriptionLimits[currentUser.subscription] || 10;
          localStorage.setItem('acioai_user', JSON.stringify(currentUser));
          
          showMainApp();
        } else {
          const errorMsg = data.error || 'Ø®Ø·Ø§ Ø¯Ø± Ø¹Ù…Ù„ÛŒØ§Øª';
          if (errorMsg === 'EMAIL_EXISTS') {
            showError('Ø§ÛŒÙ† Ø§ÛŒÙ…ÛŒÙ„ Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª');
          } else if (errorMsg === 'USER_NOT_FOUND') {
            showError('Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ø§ÛŒÙ…ÛŒÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯');
          } else {
            showError(errorMsg);
          }
        }
      } catch (error) {
        showError('Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±');
      } finally {
        authSubmit.disabled = false;
        authSubmit.textContent = isLoginMode ? 'ÙˆØ±ÙˆØ¯' : 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…';
      }
    }
    
    function showMainApp() {
      authScreen.classList.add('hidden');
      mainApp.classList.remove('hidden');
      
      userDisplay.textContent = currentUser.name;
      profileName.textContent = currentUser.name;
      profileEmail.textContent = emailInput.value || currentUser.email || 'email@example.com';
      profileAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
      profileSubscription.textContent = currentUser.subscription;
      
      maxMessages = subscriptionLimits[currentUser.subscription] || 10;
      updateMessageCounter();
      updateProfileStats();
      loadAds();
    }
    
    function logout() {
      currentUser = null;
      dailyMessages = 0;
      chatHistory = [];
      localStorage.removeItem('acioai_user');
      
      const messages = chatMessages.querySelectorAll('[data-timestamp]');
      messages.forEach(msg => msg.remove());
      
      mainApp.classList.add('hidden');
      authScreen.classList.remove('hidden');
      
      emailInput.value = '';
      nameInput.value = '';
      authError.classList.add('hidden');
    }
    
    // Chat Functions
    function updateMessageCounter() {
      messageCounter.textContent = `${dailyMessages} Ø§Ø² ${maxMessages} Ù¾ÛŒØ§Ù… Ø§Ù…Ø±ÙˆØ²`;
      updateProfileStats();
    }
    
    function updateProfileStats() {
      profileMessages.textContent = `${dailyMessages} / ${maxMessages}`;
      const progress = (dailyMessages / maxMessages) * 100;
      profileProgress.style.width = `${Math.min(progress, 100)}%`;
    }
    
    function addMessageToChat(role, text, timestamp) {
      const bubble = document.createElement('div');
      bubble.dataset.timestamp = timestamp;
      bubble.className = `fade-in max-w-[85%] ${role === 'user' ? 'chat-bubble-user mr-auto' : 'chat-bubble-ai ml-auto'}`;
      
      const p = document.createElement('p');
      p.className = role === 'user' ? 'text-white p-4' : 'text-gray-700 p-4';
      p.textContent = text;
      
      bubble.appendChild(p);
      chatMessages.appendChild(bubble);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function addTypingIndicator() {
      const typing = document.createElement('div');
      typing.id = 'typing-indicator';
      typing.className = 'chat-bubble-ai p-4 max-w-[85%] fade-in';
      typing.innerHTML = `
        <div class="flex gap-1 items-center">
          <div class="w-2 h-2 bg-emerald-500 rounded-full typing-dot"></div>
          <div class="w-2 h-2 bg-emerald-500 rounded-full typing-dot"></div>
          <div class="w-2 h-2 bg-emerald-500 rounded-full typing-dot"></div>
        </div>
      `;
      chatMessages.appendChild(typing);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function removeTypingIndicator() {
      const typing = document.getElementById('typing-indicator');
      if (typing) typing.remove();
    }
    
    async function sendMessage(e) {
      e.preventDefault();
      
      const text = chatInput.value.trim();
      if (!text || isLoading) return;
      
      if (dailyMessages >= maxMessages) {
        addMessageToChat('ai', 'Ø´Ù…Ø§ Ø¨Ù‡ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡ Ø±Ø³ÛŒØ¯Ù‡â€ŒØ§ÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨ÛŒØ´ØªØ±ØŒ Ø§Ø´ØªØ±Ø§Ú© Ø®ÙˆØ¯ Ø±Ø§ Ø§Ø±ØªÙ‚Ø§ Ø¯Ù‡ÛŒØ¯.', new Date().toISOString());
        return;
      }
      
      isLoading = true;
      chatInput.value = '';
      sendBtn.disabled = true;
      
      const userTimestamp = new Date().toISOString();
      addMessageToChat('user', text, userTimestamp);
      
      dailyMessages++;
      updateMessageCounter();
      
      addTypingIndicator();
      
      try {
        const url = `${API_BASE}?action=chat&userid=${currentUser.userId}&text=${encodeURIComponent(text)}`;
        const response = await fetch(url);
        const data = await response.json();
        
        removeTypingIndicator();
        
        let aiResponse = 'Ù…ØªØ£Ø³ÙØ§Ù†Ù‡ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ù…Ø´Ú©Ù„ÛŒ Ù¾ÛŒØ´ Ø¢Ù…Ø¯.';
        if (data.ok && data.Result) {
          aiResponse = data.Result;
        } else if (data.error === 'DAILY_LIMIT_REACHED') {
          aiResponse = 'Ø´Ù…Ø§ Ø¨Ù‡ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡ Ø±Ø³ÛŒØ¯Ù‡â€ŒØ§ÛŒØ¯.';
        }
        
        const aiTimestamp = new Date().toISOString();
        addMessageToChat('ai', aiResponse, aiTimestamp);
        
      } catch (error) {
        removeTypingIndicator();
        addMessageToChat('ai', 'Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.', new Date().toISOString());
      } finally {
        isLoading = false;
        sendBtn.disabled = false;
        chatInput.focus();
      }
    }
    
    // Navigation
    function switchPage(pageName) {
      const pages = ['chat', 'faq', 'ads', 'profile'];
      pages.forEach(page => {
        const pageEl = document.getElementById(`${page}-page`);
        const navEl = document.querySelector(`[data-page="${page}"]`);
        
        if (page === pageName) {
          pageEl.classList.remove('hidden');
          navEl.classList.add('active');
          
          const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
          const primary = config.primary_color || defaultConfig.primary_color;
          const accent = config.accent_color || defaultConfig.accent_color;
          navEl.style.background = `linear-gradient(135deg, ${primary} 0%, ${accent} 100%)`;
          navEl.style.color = 'white';
        } else {
          pageEl.classList.add('hidden');
          navEl.classList.remove('active');
          navEl.style.background = '';
          navEl.style.color = '';
        }
      });
    }
    
    // Load Ads
    async function loadAds() {
      try {
        const response = await fetch(`${API_BASE}?action=ads`);
        const data = await response.json();
        
        adsLoading.classList.add('hidden');
        
        if (data.ok && data.Result && data.Result.length > 0) {
          adsData = data.Result;
          renderAds();
        } else {
          adsList.innerHTML = `
            <div class="text-center py-8 text-gray-500">
              <div class="text-4xl mb-2">ğŸ“­</div>
              <p>Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± ØªØ¨Ù„ÛŒØºÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</p>
            </div>
          `;
        }
      } catch (error) {
        adsLoading.classList.add('hidden');
        adsList.innerHTML = `
          <div class="text-center py-8 text-gray-500">
            <div class="text-4xl mb-2">âš ï¸</div>
            <p>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ¨Ù„ÛŒØºØ§Øª</p>
          </div>
        `;
      }
    }
    
    function renderAds() {
      adsList.innerHTML = adsData.map(ad => `
        <a href="${ad.url}" target="_blank" rel="noopener noreferrer" class="ad-card glass-card rounded-2xl overflow-hidden block">
          <img src="${ad.image}" alt="${ad.name}" class="w-full h-48 object-cover" loading="lazy" onerror="this.style.background='linear-gradient(135deg, #10B981 0%, #059669 100%)'; this.alt='Image unavailable';">
          <div class="p-4">
            <h3 class="font-medium text-gray-800">${ad.name}</h3>
          </div>
        </a>
      `).join('');
    }
    
    // FAQ Search
    async function searchFAQ() {
      const query = faqSearch.value.trim();
      if (!query) return;
      
      try {
        const response = await fetch(`${API_BASE}?action=faq&query=${encodeURIComponent(query)}`);
        const data = await response.json();
        
        if (data.ok && data.Result) {
          const faqList = document.getElementById('faq-list');
          faqList.innerHTML = `
            <div class="glass-card rounded-xl p-4 fade-in">
              <h3 class="font-medium text-gray-800 mb-2">${query}</h3>
              <p class="text-gray-600 text-sm">${data.Result}</p>
            </div>
          `;
        }
      } catch (error) {
        console.error('FAQ search error');
      }
    }
    
    // Event Listeners
    toggleAuth.addEventListener('click', toggleAuthMode);
    authForm.addEventListener('submit', handleAuth);
    logoutBtn.addEventListener('click', logout);
    chatForm.addEventListener('submit', sendMessage);
    
    document.querySelectorAll('[data-page]').forEach(btn => {
      btn.addEventListener('click', () => switchPage(btn.dataset.page));
    });
    
    faqSearch.addEventListener('input', () => {
      clearTimeout(faqSearch.searchTimeout);
      faqSearch.searchTimeout = setTimeout(searchFAQ, 500);
    });
    
    // Initialize
    initializeApp();
  </script>
</body>
</html>
